<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    
    <title>Spring Boot 配置 properties 文件案例教程 | 程序员泥瓦匠</title>

    <meta name="description" content="&lt;p&gt;Spring Boot 配置，包括自动配置和外化配置。本章先实现自定义属性工程，将属性外化配置在 application.properties 应用配置文件，然后在工程中获取该属性值。接着会详细介绍属性的获取方式、外化配置和自动配置。最后会介绍利用自动配置自定义 Start 组件。&lt;/p&gt;">
    <link rel="canonical" href="https://bysocket.com/spring-boot-configuration-properties-example/"/>
    <meta name="keywords" content="">


    

    <meta property="og:locale" content="cn" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content= "Spring Boot 配置 properties 文件案例教程 | 程序员泥瓦匠"  />
    <meta property="og:description" content= "&lt;p&gt;Spring Boot 配置，包括自动配置和外化配置。本章先实现自定义属性工程，将属性外化配置在 application.properties 应用配置文件，然后在工程中获取该属性值。接着会详细介绍属性的获取方式、外化配置和自动配置。最后会介绍利用自动配置自定义 Start 组件。&lt;/p&gt;" />
    <meta property="og:url" content="https://bysocket.com/spring-boot-configuration-properties-example/index.html" />
    <meta property="og:site_name" content="" />
    <meta property="article:author" content="泥瓦匠" />
    <meta property="article:publisher" content="" />
    <meta property="og:description" content="&lt;p&gt;Spring Boot 配置，包括自动配置和外化配置。本章先实现自定义属性工程，将属性外化配置在 application.properties 应用配置文件，然后在工程中获取该属性值。接着会详细介绍属性的获取方式、外化配置和自动配置。最后会介绍利用自动配置自定义 Start 组件。&lt;/p&gt;" />
    <meta name="twitter:title" content="Spring Boot 配置 properties 文件案例教程 | 程序员泥瓦匠"/>
    <meta name="twitter:description" content="&lt;p&gt;Spring Boot 配置，包括自动配置和外化配置。本章先实现自定义属性工程，将属性外化配置在 application.properties 应用配置文件，然后在工程中获取该属性值。接着会详细介绍属性的获取方式、外化配置和自动配置。最后会介绍利用自动配置自定义 Start 组件。&lt;/p&gt;"/>
    <script type="application/ld+json">
        {
            "description": "&lt;p&gt;Spring Boot 配置，包括自动配置和外化配置。本章先实现自定义属性工程，将属性外化配置在 application.properties 应用配置文件，然后在工程中获取该属性值。接着会详细介绍属性的获取方式、外化配置和自动配置。最后会介绍利用自动配置自定义 Start 组件。&lt;/p&gt;",
            "author": { "@type": "Person", "name": "泥瓦匠" },
            "@type": "BlogPosting",
            "url": "https://bysocket.com/spring-boot-configuration-properties-example/index.html",
            "publisher": {
            "@type": "Organization",
            "logo": {
                "@type": "ImageObject",
                "url": "https://bysocket.comhttps://image.bysocket.com/avatar.webp?dpr=0.1"
            },
            "name": "泥瓦匠"
            },
            "headline": "Spring Boot 配置 properties 文件案例教程 | 程序员泥瓦匠",
            "datePublished": "2023-02-07T06:37:15.000Z",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://bysocket.com/spring-boot-configuration-properties-example/index.html"
            },
            "@context": "http://schema.org"
        }
    </script>




    

    

    

    

    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📚</text></svg>">
    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1654266144177.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1654266144177.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = false

    </script>

    <!-- Google 广告 AdSense 代码 -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2686883599479094" crossorigin="anonymous"></script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-avatar avatar avatar-sm">
                <img src="https://image.bysocket.com/avatar.webp?dpr=0.1" alt="泥瓦匠">
            </div>
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>程序员泥瓦匠</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">首页</a>
                
                <a href="/archives">存档</a>
                
                <a href="/about">关于</a>
                
            </div>
            <div class="header-menu-social">
                
    <a class="social" target="_blank" href="https://github.com/JeffLi1993">
        <ion-icon name="logo-github"></ion-icon>
    </a>

    <a class="social" target="_blank" href="https://twitter.com/CoderJeffLee">
        <ion-icon name="logo-twitter"></ion-icon>
    </a>

            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">首页</a>
                    
                    <a href="/archives">存档</a>
                    
                    <a href="/about">关于</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-cldtvdihp00042l3sble9cx6t" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      Spring Boot 配置 properties 文件案例教程
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2023-02-07T06:37:15.000Z" itemprop="datePublished">2023-02-07</time>
</div>

            
            <div class="article-category">
                <a class="article-category-link" href="/categories/Spring-Boot/">Spring Boot</a>
            </div>
            

            
            <div class="article-tag">
                <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Config/" rel="tag">Config</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Properties/" rel="tag">Properties</a></li></ul>
            </div>
            

            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <p>Spring Boot 配置，包括自动配置和外化配置。本章先实现自定义属性工程，将属性外化配置在 application.properties 应用配置文件，然后在工程中获取该属性值。接着会详细介绍属性的获取方式、外化配置和自动配置。最后会介绍利用自动配置自定义 Start 组件。</p>
<span id="more"></span>


<h2 id="2-1-快速入门工程"><a href="#2-1-快速入门工程" class="headerlink" title="2.1 快速入门工程"></a>2.1 快速入门工程</h2><p>第一章的 <code>HelloBookController</code> 控制层中，在代码中以硬编码的方式使用字符串表示书信息。下面把书的信息作为属性，外化配置在 application.properties 。好处是将应用参数、业务参数或第三方参数等统一配置在应用配置文件中，避免配置侵入业务代码，达到可配置的方式，方便及时调整修改。</p>
<h3 id="2-1-1-配置属性"><a href="#2-1-1-配置属性" class="headerlink" title="2.1.1 配置属性"></a>2.1.1 配置属性</h3><p>新建工程命名为 chapter-2-spring-boot-config ，在 application.properties 中配置书名和作者，配置如下：</p>
<pre><code>    ## 书信息
    demo.book.name=[Spring Boot 2.x Core Action]
    demo.book.writer=BYSocket
</code></pre>
<p>.properties 文件的每行参数被存储为一对字符串，即一个存储参数名称，被称为键；另一个为值。一般称为键值对配置。井号（#）或者英文状态下的叹号（!）作为第一行中第一个非空字符来表示该行的文本为注释。另外，反斜杠（\）用于转义字符。</p>
<p>Spring Boot 支持并推荐使用 YAML 格式的配置文件，将 application.properties 文件替换成 application.yml 文件，并配置相同的属性，配置如下：</p>
<pre><code>## 书信息
demo:
    book:
        name: 《Spring Boot 2.x 核心技术实战 - 上 基础篇》
        writer: 泥瓦匠BYSocket
</code></pre>
<p>YAML 是一个可读性高，用来表达数据序列的格式。表示键值对格式时，注意键和值由冒号及空白字符分开。强调下，空白字符是必须的，IDE 一般也会提示。两种配置方式都非常便捷，在开发中选择 .properties 或 .yml 文件配置。但如果两种配置文件同时存在的时候，默认优先使用 .properties 配置文件。YAML 与 .properties 配置文件对比如图 2-1 所示：</p>
<p><img src="https://image.bysocket.com/2023/02/1-2.webp?dpr=0.7"></p>
<p>图 2-1 YAML 与 .properties 配置文件对比</p>
<p>注意：</p>
<p>在 application.properties 配置中文值，读取时会出现中文乱码问题。因为 Java .properties 文件默认编码方式是 iso-8859 ，Spring Boot 应用以 UTF-8 的编码方式读取，就导致出现乱码问题。</p>
<p>官方 Issue 中的解决方法是，将 .properties 文件中配置的中文值转义成 Unicode 编码形式。例如 <code>demo.book.writer=泥瓦匠</code> 应该配置成 <code>demo.book.writer=\u6ce5\u74e6\u5320</code> 。利用 IDEA properties 插件 或利用 Java 文件转码工具 native2ascii 来快速地进行转义。该工具有在线版实现，地址如下： <a target="_blank" rel="noopener" href="https://javawind.net/tools/native2ascii.jsp">https://javawind.net/tools/native2ascii.jsp</a></p>
<h3 id="2-1-2-创建属性类"><a href="#2-1-2-创建属性类" class="headerlink" title="2.1.2 创建属性类"></a>2.1.2 创建属性类</h3><p>在工程中新建包目录 <code>demo.springboot.config</code> ，并在目录中创建名为 BookProperties 的属性类，代码如下：</p>
<pre><code>import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

/**
 * 书属性
 */
@Component
public class BookProperties &#123;

    /**
     * 书名
     */
    @Value(&quot;$&#123;demo.book.name&#125;&quot;)
    private String name;

    /**
     * 作者
     */
    @Value(&quot;$&#123;demo.book.writer&#125;&quot;)
    private String writer;

    // ... 省略 getter / setter 方法
&#125;
</code></pre>
<p>利用 <code>@Component</code> 注解定义了书的属性 Bean，并通过 <code>@Value</code> 注解为该 Bean 的成员变量（或者方法参数）自动注入 application.properties 文件的属性值。<code>@Value</code> 注解是通过 “${propName}” 的形式引用属性，propName 表示属性名称。</p>
<p>核心注解的知识点：</p>
<ul>
<li><p>@Component 注解： <code>@Component</code> 对类进行标注，职责是泛指组件 Bean ，应用启动时会被容器加载并加入容器管理。常见的 <code>@Controller</code>、<code>@Service</code> 、<code>@Repository</code> 是 <code>@Component</code> 的分类细化组件，分别对应控制层、服务层、持久层的 Bean。</p>
</li>
<li><p>@Value 注解： <code>@Value</code> 对 Bean 的字段或者方法参数进行标注，职责是基于表达式给字段或方法参数设置默认属性值。通常格式是注解 + SpEL 表达式，如 <code>@Value(&quot;SpEL 表达式&quot;)</code>。</p>
</li>
</ul>
<p>使用 <code>@Vlaue</code> 注解来引用属性值时，确保所引用的属性值在 application.properties 文件存在并且相对应匹配，否则会造成 Bean 的创建错误，引发 <code>java.lang.IllegalArgumentException</code> 非法参数异常。</p>
<h3 id="2-1-3-获取属性"><a href="#2-1-3-获取属性" class="headerlink" title="2.1.3 获取属性"></a>2.1.3 获取属性</h3><p>修改原有的 <code>HelloBookController</code> 类，通过注入的方式获取书属性 Bean 并返回。代码如下：</p>
<pre><code>import demo.springboot.config.BookProperties;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloBookController &#123;

    @Autowired
    BookProperties bookProperties;

    @GetMapping(&quot;/book/hello&quot;)
    public String sayHello() &#123;
        return &quot;Hello， &quot; + bookProperties.getWriter() + &quot; is writing &quot;
                + bookProperties.getName() + &quot; ！&quot;;
    &#125;
&#125;
</code></pre>
<p>通过 <code>@Autowired</code> 注解标记在 <code>BookProperties</code> 字段，控制层自动装配属性 Bean 并使用。默认情况下要求被注解的 Bean 必须存在，需要允许 NULL 值，可以设置其 required 属性为 false： <code>@Autowired(required = false)</code>。</p>
<h3 id="2-1-4-运行工程"><a href="#2-1-4-运行工程" class="headerlink" title="2.1.4 运行工程"></a>2.1.4 运行工程</h3><p>执行 <code>ConfigApplication</code> 类启动，在控制台看到成功运行的输出后，打开浏览器访问 &#x2F;book&#x2F;hello 地址，可以看到如图 2-2 所示的返回结果：</p>
<p><img src="https://image.bysocket.com/2023/02/1-3.webp?dpr=0.7"></p>
<p>图 2-2 Hello Book 页面</p>
<p>也可以通过单元测试的方式验证属性获取是否成功，单元测试具体相关的会在第 9 章节介绍。单元测试代码如下：</p>
<pre><code>import demo.springboot.config.BookProperties;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest
public class ConfigApplicationTests &#123;
    @Autowired
    BookProperties bookProperties;

    @Test
    public void testBookProperties() &#123;
        Assert.assertEquals(bookProperties.getName(),&quot;&#39;Spring Boot 2.x Core Action&#39;&quot;);
        Assert.assertEquals(bookProperties.getWriter(),&quot;BYSocket&quot;);
    &#125;
&#125;
</code></pre>
<h2 id="2-2-配置属性的获取方式"><a href="#2-2-配置属性的获取方式" class="headerlink" title="2.2 配置属性的获取方式"></a>2.2 配置属性的获取方式</h2><p>配置属性的常用获取方式有基于 <code>@Value</code> 和 <code>@ConfigurationProperties</code> 注解两种方式。两种方式适合的场景不同，下面具体介绍其使用方法和场景。</p>
<h3 id="2-2-1-Value-注解"><a href="#2-2-1-Value-注解" class="headerlink" title="2.2.1 @Value 注解"></a>2.2.1 @Value 注解</h3><p><code>@Value</code> 注解对 Bean 的变量或者方法参数进行标注，职责是基于表达式给字段或方法参数设置默认属性值。通常格式是注解 + SpEL 表达式，如 <code>@Value(&quot;SpEL 表达式&quot;)</code>，并标注在对应的字段或者方法上方，且必须对变量一一标注。这种方式适用于小而不复杂的属性结构。属性结构复杂，字段很多的情况下，这种方式会比较繁琐，应该考虑使用 <code>@ConfigurationProperties</code> 注解。</p>
<p>另外通过 <code>@PropertySource</code> 注解引入对应路径的其他 .properties 文件。将书信息重新配置在 classpath 下新的 book.properties 配置文件后，读取新配置文件的代码如下：</p>
<pre><code>import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.PropertySource;
import org.springframework.stereotype.Component;

/**
 * 书属性
 */
@Component
@PropertySource(&quot;classpath:book.properties&quot;)
public class BookProperties &#123;

    /**
     * 书名
     */
    @Value(&quot;$&#123;demo.book.name&#125;&quot;)
    private String name;

    /**
     * 作者
     */
    @Value(&quot;$&#123;demo.book.writer&#125;&quot;)
    private String writer;

    // ... 省略 getters / setters 方法
&#125;
</code></pre>
<h3 id="2-2-2-ConfigurationProperties-注解"><a href="#2-2-2-ConfigurationProperties-注解" class="headerlink" title="2.2.2 @ConfigurationProperties 注解"></a>2.2.2 @ConfigurationProperties 注解</h3><p>在包目录 <code>demo.springboot.config</code> 中创建名为 BookComponent 的属性类，并使用 <code>@ConfigurationProperties</code> 注解获取属性，代码如下：</p>
<pre><code>import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;

/**
 * 书属性
 *
 */
@Component
@ConfigurationProperties(prefix = &quot;demo.book&quot;)
public class BookComponent &#123;

    /**
     * 书名
     */
    private String name;

    /**
     * 作者
     */
    private String writer;

    // ... 省略 getters / setters 方法
&#125;
</code></pre>
<p>类似 <code>@Value</code> 注解方式，使用 <code>@ConfigurationProperties(prefix = &quot;demo.book&quot;)</code> 注解标注在类上方可以达到相同的效果。 <code>@ConfigurationProperties</code> 注解的 prefix 是指定属性的参数名称。会匹配到配置文件中 “ demo.book. <em>” 结构的属性，星号 “</em> ” 是指会一一对应匹配 <code>BookComponent</code> 类的字段名。例如，字段 name 表示书名，会匹配到 <code>demo.book.name</code> 属性值。</p>
<p><code>@Value</code> 注解方式强制字段必须对应在配置文件， <code>@ConfigurationProperties</code> 注解方式则不是必须的。一般情况下，所有字段应该保证一一对应在配置文件。如果没有属性值对应的话，该字段默认为空， <code>@ConfigurationProperties</code> 注解方式也不会引发任何异常，Spring Boot 推荐使用 <code>@ConfigurationProperties</code> 注解方式获取属性。</p>
<p>同样使用单元测试验证获取属性是否成功。单元测试代码如下：</p>
<pre><code>@Autowired
BookComponent bookComponent;

@Test
public void testBookComponent() &#123;
    Assert.assertEquals(bookComponent.getName(),&quot;&#39;Spring Boot 2.x Core Action&#39;&quot;);
    Assert.assertEquals(bookComponent.getWriter(),&quot;BYSocket&quot;);
&#125;
</code></pre>
<h5 id="API-org-springframework-boot-context-properties-ConfigurationProperties-注解参数"><a href="#API-org-springframework-boot-context-properties-ConfigurationProperties-注解参数" class="headerlink" title="API org.springframework.boot.context.properties.ConfigurationProperties 注解参数"></a>API org.springframework.boot.context.properties.ConfigurationProperties 注解参数</h5><ul>
<li>prefix 字符串值，绑定该名称前缀的属性对象。</li>
<li>value 字符串值，功能同 prefix 参数。</li>
<li>ignoreInvalidFields 布尔值，默认 false。绑定对象时，忽略无效字段。</li>
<li>ignoreUnknownFields 布尔值，默认 true。绑定对象时，忽略未知字段。</li>
</ul>
<h3 id="2-2-3-ConfigurationProperties-数据验证"><a href="#2-2-3-ConfigurationProperties-数据验证" class="headerlink" title="2.2.3 @ConfigurationProperties 数据验证"></a>2.2.3 @ConfigurationProperties 数据验证</h3><p><code>@ConfigurationProperties</code> 注解方式支持验证功能，即当属性类被 <code>@Validated</code> 注解标注时，Spring Boot 初始化时会验证类的字段。在类的字段上添加 JSR-303 约束注解，进行数据验证。下面为书属性字段添加非 NULL 和字符串非空约束，代码如下：</p>
<pre><code>import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;
import org.springframework.validation.annotation.Validated;

import javax.validation.constraints.NotEmpty;
import javax.validation.constraints.NotNull;

/**
 * 书属性
 *
 */
@Component
@ConfigurationProperties(prefix = &quot;demo.book&quot;)
@Validated
public class BookComponent &#123;

    /**
     * 书名
     */
    @NotEmpty
    private String name;

    /**
     * 作者
     */
    @NotNull
    private String writer;

    // ... 省略 getters / setters 方法
&#125;
</code></pre>
<p>通过 <code>@Validated</code> 注解开启对 <code>BookComponent</code> 类字段的数据验证，如果 name 字段为 NULL 或者为空字符串时，会引发 <code>BindValidationException</code> 绑定数据验证异常。数据验证常用在邮箱格式或者有长度限制的属性字段。另外，验证嵌套属性的值，必须在嵌套对象字段上方标注 <code>@Valid</code> 注解，用来触发其验证。例如，在书属性中新增嵌套对象出版社 <code>Publishing</code>，就需要在该对象上方标注 <code>@Valid</code> 注解，来开启对 <code>Publishing</code> 对象的数据验证。综上，两种属性获取方式各有优缺点，对比如图 2-3 所示：</p>
<p><img src="https://image.bysocket.com/2023/02/1-4.webp?dpr=0.7"></p>
<p>图 2-3 @ConfigurationPropertiesd vs @Value</p>
<h2 id="2-3-外化配置"><a href="#2-3-外化配置" class="headerlink" title="2.3 外化配置"></a>2.3 外化配置</h2><p>Spring Boot 可以将配置外部化，即分离存储在 classpath 之外，这种模式叫做 “外化配置”。常用在不同环境中，将配置从代码中分离外置，只要简单地修改下外化配置，可以依旧运行相同的应用代码。外化配置表现形式不单单是 .properties 和 .yml 属性文件，还可以使用环境变量和命令行参数等来实现。那么，多处配置了相同属性时，Spring Boot 是通过什么方式来控制外化配置的冲突呢？答案是外化配置优先级。</p>
<h3 id="2-3-1-外化配置优先级"><a href="#2-3-1-外化配置优先级" class="headerlink" title="2.3.1 外化配置优先级"></a>2.3.1 外化配置优先级</h3><p>用命令行配置去覆盖 .properties 文件配置方法很简单。正常情况下利用 Java 命令运行工程，代码如下：</p>
<pre><code>// chapter-2-spring-boot-config 目录下运行
java -jar target/chapter-2-spring-boot-config-1.0.jar
</code></pre>
<p>下面将书的作者信息 BYSocket 改成 Jeff ， 通过命令行配置覆盖属性，代码如下：</p>
<pre><code>java -jar target/chapter-2-spring-boot-config-1.0.jar --demo.book.writer=Jeff
</code></pre>
<p>在命令行配置中，设置属性值的格式是用两个连续的减号 “–”标志属性。在控制台看到成功运行的输出后，打开浏览器，访问 &#x2F;book&#x2F;hello 地址，可以看到如图 2-4 所示的返回结果：</p>
<p><img src="https://image.bysocket.com/2023/02/1-5.webp?dpr=0.7"></p>
<p>图 2-4 书信息被覆盖页面</p>
<p>通过命令行配置覆盖属性提供了非常大的作用与便利性，常见于使用 shell 脚本运行工程时，可以方便地修改工程运行的配置。</p>
<p>但是这就引发了一个问题，岂不让工程很有侵入性，如果开放这个功能，导致未知的安全问题。所以 Spring Boot 提供了屏蔽命令行属性值设置，在应用启动类中设置 <code>setAddCommandLineProperties</code> 方法为 <code>false</code> ，用于关闭命令行配置功能，代码如下：</p>
<pre><code>SpringApplication.setAddCommandLineProperties(false);
</code></pre>
<p>命令行配置属性的优先级是第四。外化配置获取属性时，会按优先级从高到低获取。如果高优先级存在属性，则返回属性，并忽略优先级低的属性。优先级如下：</p>
<ol>
<li>本地 Devtools 全局配置</li>
<li>测试时 <code>@TestPropertySource</code> 注解配置</li>
<li>测试时 <code>@SpringBootTest</code> 注解的 properties 配置</li>
<li>命令行配置</li>
<li>SPRING_APPLICATION_JSON 配置</li>
<li><code>ServletConfig</code> 初始化参数配置</li>
<li><code>ServletContext</code> 初始化参数配置</li>
<li>Java 环境的 JNDI 参数配置</li>
<li>Java 系统的属性配置</li>
<li>OS 环境变量配置</li>
<li>只能随机属性的 <code>RandomValuePropertySource</code> 配置</li>
<li>工程 jar 之外的多环境配置文件（application- {profile}.properties 或 YAML）</li>
<li>工程 jar 之内的多环境配置文件（application- {profile}.properties 或 YAML）</li>
<li>工程 jar 之外的应用配置文件（application.properties 或 YAML）</li>
<li>工程 jar 之内的应用配置文件（application.properties 或 YAML）</li>
<li><code>@Configuration</code> 类中的 @PropertySource 注解配置</li>
<li>默认属性配置（<code>SpringApplication.setDefaultProperties</code> 指定）</li>
</ol>
<h3 id="2-3-2-属性引用"><a href="#2-3-2-属性引用" class="headerlink" title="2.3.2 属性引用"></a>2.3.2 属性引用</h3><p>在 application.properties 中配置属性时，属性之间可以直接通过 “${propName}” 的形式引用其他属性。比如新增书的描述 description 属性，代码如下：</p>
<pre><code>## 书信息
demo.book.name=[Spring Boot 2.x Core Action]
demo.book.writer=BYSocket
demo.book.description=$&#123;demo.book.writer&#125;&#39;s$&#123;demo.book.name&#125;
</code></pre>
<p>demo.book.description 属性引用了前面定义的 demo.book.name 和 demo.book.writer 属性，其值为 BYSocket’s[Spring Boot 2.x Core Action] 。一方面可以使相同配置可以复用，另一方面增强了配置的阅读性。</p>
<h3 id="2-3-3-使用随机数"><a href="#2-3-3-使用随机数" class="headerlink" title="2.3.3 使用随机数"></a>2.3.3 使用随机数</h3><p>在 application.properties 中配置属性时，可以使用随机数配置，例如注入某些密钥、UUID 或者测试用例，需要每次不是一个固定的值。<code>RandomValuePropertySource</code> 类随机提供整形、长整形数、UUID 或者字符串。使用代码如下：</p>
<pre><code>my.secret=$&#123;random.value&#125;
my.number=$&#123;random.int&#125;
my.bignumber=$&#123;random.long&#125;
my.uuid=$&#123;random.uuid&#125;
my.number.less.than.ten=$&#123;random.int(10)&#125;
my.number.in.range=$&#123;random.int[1024,65536]&#125;
</code></pre>
<h3 id="2-3-4-多环境配置"><a href="#2-3-4-多环境配置" class="headerlink" title="2.3.4 多环境配置"></a>2.3.4 多环境配置</h3><p>多环境是指不同配置的生产服务器使用同一工程代码部署，比如：开发环境、测试环境、预发环境、生产环境等。各个环境的工程端口、数据库配置、Redis 配置、日志配置等都会不同，传统模式下需要修改配置，工程重新编译打包，并部署到指定环境服务器。结果是容易发生配置错误，导致开发部署效率低下。Spring Boot 使用多环境配置去解决这个问题。</p>
<p>多环境配置，类似 Maven 构建配置文件的思路，即配置多个不同环境的配置文件，再通过 <code>spring.profiles.active</code> 命令去指定读取特定配置文件的属性。多环境配置文件是不同于 application.properties 应用配置文件。多环境配置文件的约定命名格式为 application-{profile}.properties。多环境配置功能默认为激活状态，如果其他配置未被激活，则 {profile} 默认为 default，会加载 application-default.properties 默认配置文件，没有该文件就会加载 application.properties 应用配置文件。</p>
<p>多环境配置文件的属性读取方式和从 application.properties 应用配置文件读取方式一致。不管多环境配置文件在工程 jar 包内还是包外，按照配置优先级覆盖其他配置文件。在微服务实践开发中，经常会使用一个类似 deploy 工程去管理配置文件和打包其他业务工程。</p>
<p>在 application.properties 同级目录中，新建 application-dev.properties 作为开发环境配置文件，配置如下：</p>
<pre><code>## 书信息
demo.book.name=[Spring Boot 2.x Core Action]  From Dev
demo.book.writer=BYSocket
</code></pre>
<p>新建 application-prod.properties 作为生产环境配置文件，代码如下：</p>
<pre><code>## 书信息
demo.book.name=&lt;Spring Boot 2.x Core Action Dev&gt; From Prod
demo.book.writer=BYSocket
</code></pre>
<p>通过命令行指定读取 dev 环境配置文件并运行工程，代码如下：</p>
<pre><code>java -jar target/chapter-2-spring-boot-config-1.0.jar --spring.profiles.active=dev
</code></pre>
<p>在多个环境配置中，通过命令 <code>--spring.profiles.active=dev</code> 指定读取某个配置文件，将 dev 更改成 prod ，轻松切换读取生产环境配置。也可以在控制台的日志中确定配置读取来自 dev ：</p>
<pre><code>2017-11-09 12:10:52.978  INFO 72450 --- [           main] demo.springboot.ConfigApplication        : The following profiles are active: dev
</code></pre>
<p>最后打开浏览器，访问 &#x2F;book&#x2F;hello 地址，可以看到如图 2-5 所示的返回结果：</p>
<p><img src="https://image.bysocket.com/2023/02/1-6.webp?dpr=0.7"></p>
<p>图 2-5 dev 环境书信息页面</p>
<h2 id="2-4-自动配置"><a href="#2-4-自动配置" class="headerlink" title="2.4 自动配置"></a>2.4 自动配置</h2><p>Spring Boot <code>spring-boot-autoconfigure</code> 依赖实现了默认的配置项，即应用默认值。这种模式叫做 “自动配置”。Spring Boot 自动配置会根据添加的依赖，自动加载依赖相关的配置属性并启动依赖。例如默认用的内嵌式容器是 Tomcat ，端口默认设置为 8080。</p>
<p>为什么需要自动配置？顾名思义，自动配置的意义是利用这种模式代替了配置 XML 繁琐模式。以前使用 Spring MVC ，需要进行配置组件扫描、调度器、视图解析器等，使用 Spring Boot 自动配置后，只需要添加 MVC 组件即可自动配置所需要的 Bean。所有自动配置的实现都在 <code>spring-boot-autoconfigure</code> 依赖中，包括 Spring MVC 、Data 和其它框架的自动配置。</p>
<h3 id="2-4-1-spring-boot-autoconfigure-依赖"><a href="#2-4-1-spring-boot-autoconfigure-依赖" class="headerlink" title="2.4.1 spring-boot-autoconfigure 依赖"></a>2.4.1 spring-boot-autoconfigure 依赖</h3><p><code>spring-boot-autoconfigure</code> 依赖，是 Spring Boot 实现自动配置的核心 Starter 组件。其实现源码包结构如图 2-6 所示：</p>
<p><img src="https://image.bysocket.com/2023/02/1-7.webp?dpr=0.7"></p>
<p>图 2-6 spring-boot-autoconfigure 依赖包目录</p>
<p>从图中可以看出，其中常见核心的包如下：</p>
<pre><code>org.springframework.boot.autoconfigure
org.springframework.boot.autoconfigure.data.jpa
org.springframework.boot.autoconfigure.thymeleaf
org.springframework.boot.autoconfigure.web.servlet
org.springframework.boot.autoconfigure.web.reactive
... 省略
</code></pre>
<p>在各自包目录下有对应的自动配置类，代码如下：</p>
<pre><code>JpaRepositoriesAutoConfiguration 
ThymeleafAutoConfiguration
WebMvcAutoConfiguration
WebFluxAutoConfiguration
... 省略
</code></pre>
<p>上面自动配置类依次是 Jpa 自动配置类、Thymeleaf 自动配置类、Web MVC 自动配置类和 WebFlux 自动配置类。WebFlux 响应式框架会在第 3 章 详细介绍使用。</p>
<p><code>spring-boot-autoconfigure</code> 职责是通过 <code>@EnableAutoConfiguration</code> 核心注解，扫描 ClassPath 目录中自动配置类对应依赖，并按一定规则获取默认配置并自动初始化所需要的 Bean。在 application.properties 配置文件也可以修改默认配置项，常用配置清单地址如下：</p>
<p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html">https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html</a></p>
<h3 id="2-4-2-EnableAutoConfiguration-注解"><a href="#2-4-2-EnableAutoConfiguration-注解" class="headerlink" title="2.4.2 @EnableAutoConfiguration 注解"></a>2.4.2 @EnableAutoConfiguration 注解</h3><p>自动配置工作机制是通过 <code>@EnableAutoConfiguration</code> 注解中 <code>@Import</code> 的 <code>AutoConfigurationImportSelector</code> 自动配置导入选择器类实现的。查阅源码可得具体流程如下：</p>
<ul>
<li><code>AutoConfigurationImportSelector</code> 通过 <code>SpringFactoriesLoader.loadFactoryNames()</code> 核心方法读取 ClassPath 目录下面的 META-INF&#x2F;spring.factories 文件。</li>
<li>spring.factories 文件中配置的 Spring Boot 自动配置类，例如常见的 <code>WebMvcAutoConfiguration</code> Web MVC 自动配置类和<code>ServletWebServerFactoryAutoConfiguration</code> 容器自动配置类 。</li>
<li>spring.factories 文件和 application.properties 文件都属于配置文件，配置的格式均为键值对。里面配置的每个自动配置类都会定义相关 Bean 的实例配置，也会定义什么条件下自动配置和哪些 Bean 被实例化。</li>
<li>当 pom.xml 添加某 Starter 依赖组件的时候，就会自动触发该依赖的默认配置。</li>
</ul>
<p>例如添加 <code>spring-boot-starter-web</code> 依赖后，启动应用会触发容器自动配置类。容器自动配置类 <code>ServletWebServerFactoryAutoConfiguration</code> 的部分代码如下：</p>
<pre><code>package org.springframework.boot.autoconfigure.web.servlet;

@Configuration
@ConditionalOnClass(&#123;ServletRequest.class&#125;)
@ConditionalOnWebApplication(
    type = Type.SERVLET
)
@EnableConfigurationProperties(&#123;ServerProperties.class&#125;)
@Import(&#123;ServletWebServerFactoryAutoConfiguration.BeanPostProcessorsRegistrar.class&#125;)
public class ServletWebServerFactoryAutoConfiguration &#123;
... 省略
&#125;
</code></pre>
<p>上面代码中，<code>@ConditionalOnClass</code> 注解表示对应的 <code>ServletRequest</code> 类在 ClassPath 目录下面存在，并且 <code>@ConditionalOnWebApplication</code> 注解表示该应用是 Servlet Web 应用时，才会去启动容器自动配置，并通过 ServerProperties 类默认设置了端口为 8080。Type.SERVLET 枚举代表 Servlet Web 应用，Type.REACTIVE 枚举代表响应式 WebFlux 应用。</p>
<p>自动配置，是一把双刃剑。用好了就像天下武功唯快不破一样。但要注意一些自动化配置造成的问题。常见的问题有：</p>
<ul>
<li>Spring Boot 工程添加某些 Starter 组件依赖，又不需要触发组件自动配置</li>
<li>Spring Boot 配置多个不同数据源配置时，使用 XML 配置多数据源，但其默认数据源配置会触发自动配置出现问题。</li>
</ul>
<p>类似场景下，解决方式是通过 exclude 属性指定并排除自动配置类，代码如下：</p>
<pre><code>@SpringBootApplication(exclude = &#123;DataSourceAutoConfiguration.class&#125;)
</code></pre>
<p>也等价于配置 <code>@EnableAutoConfiguration</code> 注解，代码如下：</p>
<pre><code>@SpringBootApplication
@EnableAutoConfiguration(exclude = &#123;DataSourceAutoConfiguration.class&#125;)
</code></pre>
<p>自动配置会最大的智能化，只有配置了 exclude 属性时，Spring Boot 优先初始化用户定义的 Bean ，然后再进行自动配置。</p>
<h3 id="2-4-3-利用自动配置自定义-Starter-组件"><a href="#2-4-3-利用自动配置自定义-Starter-组件" class="headerlink" title="2.4.3 利用自动配置自定义 Starter 组件"></a>2.4.3 利用自动配置自定义 Starter 组件</h3><p>当公司需要共享或者开源 Spring Boot Starter 组件依赖包，就可以利用自动配置自定义 Starter 组件。一个完整的 Starter 组件包括以下两点：</p>
<ul>
<li>提供自动配置功能的自动配置模块。</li>
<li>提供依赖关系管理功能的组件模块，即封装了组件所有功能，开箱即用。</li>
</ul>
<p>实现自定义 Starter 组件，并不会将这两点严格区分，可以将自动配置功能和依赖管理结合在一起实现。下面利用自动配置实现自定义 Starter 组件：spring-boot-starter-swagger 组件是用来快速生成 API 文档，简化原生使用 Swagger2 。</p>
<p>spring-boot-starter-swagger 组件为 Spring For All 社区（spring4all.com）开源项目，源代码地址是 <a target="_blank" rel="noopener" href="https://github.com/SpringForAll/spring-boot-starter-swagger">https://github.com/SpringForAll/spring-boot-starter-swagger</a>。</p>
<h5 id="什么是-Swagger2"><a href="#什么是-Swagger2" class="headerlink" title="什么是 Swagger2"></a>什么是 Swagger2</h5><p>Swagger2 是 API 最大的开发框架，基于 OpenAPI 规范（OAS），管理了 API 整个生命周期，即从 API 设计到文档，从测试到部署。具体更多了解见其官网，<a target="_blank" rel="noopener" href="https://swagger.io/">https://swagger.io</a>。</p>
<h5 id="spring-boot-starter-swagger-组件依赖"><a href="#spring-boot-starter-swagger-组件依赖" class="headerlink" title="spring-boot-starter-swagger 组件依赖"></a>spring-boot-starter-swagger 组件依赖</h5><p>创建一个新的 Spring Boot 工程，命名为 spring-boot-starter-swagger。在 pom.xml 配置相关</p>
<pre><code>    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
            &lt;version&gt;$&#123;version.swagger&#125;&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
            &lt;version&gt;$&#123;version.swagger&#125;&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-bean-validators&lt;/artifactId&gt;
            &lt;version&gt;$&#123;version.swagger&#125;&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;version&gt;1.16.12&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre>
<p>配置中添加了 <code>spring-boot-starter</code> 组件依赖用于自动配置特性，<code>springfox-swagger2</code> 依赖是 Swagger2 框架。</p>
<h4 id="Swagger2-属性配置类-SwaggerProperties"><a href="#Swagger2-属性配置类-SwaggerProperties" class="headerlink" title="Swagger2 属性配置类 SwaggerProperties"></a>Swagger2 属性配置类 SwaggerProperties</h4><p>新建名为 <code>SwaggerProperties</code> Swagger2 属性配置类，包含了所有默认属性值。使用该组件时，可以在 application.properties 配置文件配置对应属性项，进行覆盖默认配置。代码如下：</p>
<pre><code>import lombok.Data;
import lombok.NoArgsConstructor;
import org.springframework.boot.context.properties.ConfigurationProperties;
import springfox.documentation.schema.ModelRef;

import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

@Data
@ConfigurationProperties(&quot;swagger&quot;)
public class SwaggerProperties &#123;

    /**是否开启swagger**/
    private Boolean enabled;

    /**标题**/
    private String title = &quot;&quot;;
    /**描述**/
    private String description = &quot;&quot;;
    /**版本**/
    private String version = &quot;&quot;;
    /**许可证**/
    private String license = &quot;&quot;;
    /**许可证URL**/
    private String licenseUrl = &quot;&quot;;
    /**服务条款URL**/
    private String termsOfServiceUrl = &quot;&quot;;

    private Contact contact = new Contact();

    /**swagger会解析的包路径**/
    private String basePackage = &quot;&quot;;

    /**swagger会解析的url规则**/
    private List&lt;String&gt; basePath = new ArrayList&lt;&gt;();
    /**在basePath基础上需要排除的url规则**/
    private List&lt;String&gt; excludePath = new ArrayList&lt;&gt;();

    /**分组文档**/
    private Map&lt;String, DocketInfo&gt; docket = new LinkedHashMap&lt;&gt;();

    /**host信息**/
    private String host = &quot;&quot;;

    /**全局参数配置**/
    private List&lt;GlobalOperationParameter&gt; globalOperationParameters;

     ... 省略，具体代码见 GitHub
&#125;
</code></pre>
<p>用 <code>@ConfigurationProperties(prefix = &quot;swagger&quot;)</code> 标注在类上方是指定属性的参数名称为 swagger。会对应匹配到配置文件中 “ swagger.* ” 结构的属性，例如，字段标题 title 表示标题，会匹配到 <code>swagger.title</code> 属性值。</p>
<h4 id="Swagger2-自动配置类-SwaggerAutoConfiguration"><a href="#Swagger2-自动配置类-SwaggerAutoConfiguration" class="headerlink" title="Swagger2 自动配置类 SwaggerAutoConfiguration"></a>Swagger2 自动配置类 SwaggerAutoConfiguration</h4><p>新建名为 <code>SwaggerAutoConfiguration</code> Swagger2 自动配置类，提供 Swagger2 依赖关系管理功能和自动配置功能。代码如下：</p>
<pre><code>import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;

@Configuration
@ConditionalOnProperty(name = &quot;swagger.enabled&quot;, matchIfMissing = true)
@Import(&#123;
        Swagger2DocumentationConfiguration.class,
        BeanValidatorPluginsConfiguration.class
&#125;)
public class SwaggerAutoConfiguration implements BeanFactoryAware &#123;

    private BeanFactory beanFactory;

    @Bean
    @ConditionalOnMissingBean
    public SwaggerProperties swaggerProperties() &#123;
        return new SwaggerProperties();
    &#125;

    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnProperty(name = &quot;swagger.enabled&quot;, matchIfMissing = true)
    public List&lt;Docket&gt; createRestApi(SwaggerProperties swaggerProperties) &#123;
        ... 省略，具体代码见 GitHub
    &#125;

    @Override
    public void setBeanFactory(BeanFactory beanFactory) throws BeansException &#123;
        this.beanFactory = beanFactory;
    &#125;
&#125;
</code></pre>
<p>上面代码实现流程如下：</p>
<ol>
<li><code>@Configuration</code> 注解标注在类上方，表明该类为配置类。</li>
<li><code>@Import</code> 注解引入 Swagger2 提供的配置类 <code>Swagger2DocumentationConfiguration</code> 和 Bean 数据验证插件配置类 <code>BeanValidatorPluginsConfiguration</code>。</li>
<li><code>@ConditionalOnMissingBean</code> 注解标注了两处方法，当 Bean 没有被创建时会执行被标注的初始化方法。第一处被标记方法是 <code>swaggerProperties()</code> ，用来实例化属性配置类 <code>SwaggerProperties</code>;第二处被标记方法是 <code>createRestApi()</code>， 用来实例化 Swagger2 API 映射的 Docket 列表对象。</li>
<li><code>@ConditionalOnProperty</code> 注解标注在 <code>createRestApi()</code> 方法，name 属性会去检查环境配置项 <code>swagger.enabled</code> 。默认情况下，属性存在且不是 <code>false</code> 的情况下，会触发该初始化方法。matchIfMissing 属性默认值为 <code>false</code> ，这里设置为 <code>true</code>，表示如果环境配置项没被设置，也会触发。</li>
</ol>
<h5 id="Swagger2-启动注解类-EnableSwagger2Doc"><a href="#Swagger2-启动注解类-EnableSwagger2Doc" class="headerlink" title="Swagger2 启动注解类 EnableSwagger2Doc"></a>Swagger2 启动注解类 EnableSwagger2Doc</h5><p>新建名为 <code>EnableSwagger2Doc</code> Swagger2 启动注解类，用于开关 spring-boot-starter-swagger 组件依赖。代码如下：</p>
<pre><code>@Target(&#123;ElementType.TYPE&#125;)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@Import(&#123;SwaggerAutoConfiguration.class&#125;)
public @interface EnableSwagger2Doc &#123;

&#125;
</code></pre>
<p>上面代码 <code>@Import</code> 注解引入 Swagger2 自动配置类 <code>SwaggerAutoConfiguration</code>。当将该注解配置在应用启动类上方，即可开启 Swagger2 自动配置及其功能。</p>
<h5 id="使用-spring-boot-starter-swagger-组件依赖"><a href="#使用-spring-boot-starter-swagger-组件依赖" class="headerlink" title="使用 spring-boot-starter-swagger 组件依赖"></a>使用 spring-boot-starter-swagger 组件依赖</h5><p>上面简单介绍了spring-boot-starter-swagger 组件的核心代码实现，同样使用方式也很简单。在 chapter-2-spring-boot-config 工程的 Maven 配置中添加对应的依赖配置，目前支持 1.5.0.RELEASE 以上版本，配置如下：</p>
<pre><code>&lt;!-- 自定义 swagger2 Starter 组件依赖 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.spring4all&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-swagger&lt;/artifactId&gt;
    &lt;version&gt;2.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>另外，需要在 ConfigApplication 应用启动类上方配置启动注解类 <code>EnableSwagger2Doc</code>，代码如下：</p>
<pre><code>import com.spring4all.swagger.EnableSwagger2Doc;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@EnableSwagger2Doc // 开启 Swagger
@SpringBootApplication
public class ConfigApplication &#123;
    public static void main(String[] args) &#123;
        SpringApplication.run(ConfigApplication.class, args);
    &#125;
&#125;
</code></pre>
<p>执行 <code>ConfigApplication</code> 类启动，在控制台看到成功运行的输出后，打开浏览器访问 localhost:8080&#x2F;swagger-ui.html 地址，可以看到自动生成的 Swagger API 文档，如图 2-7 所示：</p>
<p><img src="https://image.bysocket.com/2023/02/1-8.webp?dpr=0.7"></p>
<p>图 2-7 Swagger API 文档</p>
<h5 id="API-org-springframework-boot-autoconfigure-EnableAutoConfiguration-注解参数"><a href="#API-org-springframework-boot-autoconfigure-EnableAutoConfiguration-注解参数" class="headerlink" title="API org.springframework.boot.autoconfigure.EnableAutoConfiguration 注解参数"></a>API org.springframework.boot.autoconfigure.EnableAutoConfiguration 注解参数</h5><ul>
<li>exclude： Class 数组，排除特定的自动配置类。</li>
<li>excludeName： 字符串数组，排除特定名称的自动配置类。</li>
</ul>
<h5 id="API-org-springframework-boot-autoconfigure-ConditionalOnProperty-注解参数"><a href="#API-org-springframework-boot-autoconfigure-ConditionalOnProperty-注解参数" class="headerlink" title="API org.springframework.boot.autoconfigure.ConditionalOnProperty 注解参数"></a>API org.springframework.boot.autoconfigure.ConditionalOnProperty 注解参数</h5><ul>
<li>havingValue： 字符串，属性期望值是否匹配。</li>
<li>matchIfMissing： 布尔值，如果该属性值未设置，则匹配。</li>
<li>name： 字符串数组，要测试的属性名。</li>
<li>prefix： 字符串，属性前缀名。</li>
<li>value： 字符串，功能同 name。</li>
</ul>
<h5 id="API-org-springframework-boot-autoconfigure-ConditionalOnClass-注解参数"><a href="#API-org-springframework-boot-autoconfigure-ConditionalOnClass-注解参数" class="headerlink" title="API org.springframework.boot.autoconfigure.ConditionalOnClass 注解参数"></a>API org.springframework.boot.autoconfigure.ConditionalOnClass 注解参数</h5><ul>
<li>name： 字符串数组，类名必须存在。</li>
<li>value： Class 数组，类必须存在。</li>
</ul>
<h5 id="API-org-springframework-boot-autoconfigure-ConditionalOnMissingBean-注解参数"><a href="#API-org-springframework-boot-autoconfigure-ConditionalOnMissingBean-注解参数" class="headerlink" title="API org.springframework.boot.autoconfigure.ConditionalOnMissingBean 注解参数"></a>API org.springframework.boot.autoconfigure.ConditionalOnMissingBean 注解参数</h5><ul>
<li>annotation： 注解 Class 数组，匹配注解装饰的 Bean。</li>
<li>ignored： Class 数组，匹配时，忽略该类型的 Bean。</li>
<li>ignoredType： 字符串数组，匹配时，忽略该类型名称的 Bean。</li>
<li>name： 字符串数组，匹配要检查的 Bean 名称。</li>
<li>search： SearchStrategy 对象，通过 SearchStrategy 来决定程序的上下文策略。</li>
<li>type： 字符串史胡族，匹配要检查的 Bean 类型名称。</li>
<li>value： Class 数组，匹配要检查的 Bean 类型。</li>
</ul>
<h5 id="API-org-springframework-boot-autoconfigure-ConditionalOnWebApplication-注解参数"><a href="#API-org-springframework-boot-autoconfigure-ConditionalOnWebApplication-注解参数" class="headerlink" title="API org.springframework.boot.autoconfigure.ConditionalOnWebApplication 注解参数"></a>API org.springframework.boot.autoconfigure.ConditionalOnWebApplication 注解参数</h5><ul>
<li>type： ConditionalOnWebApplication.Type 对象，匹配对应的 Web 应用程序类型。</li>
</ul>
<h2 id="2-5-本章小结"><a href="#2-5-本章小结" class="headerlink" title="2.5 本章小结"></a>2.5 本章小结</h2><p><img src="https://image.bysocket.com/2023/02/0-1.webp?dpr=0.7"></p>
<p>本章从自定义属性快速入门工程出发，介绍了两种配置文件以及属性的获取方式，然后讲解了外化配置的优先级、属性引用、随机式使用和多环境配置，最后讲解了自动配置的原理、核心注解以及利用自动配置实现了自定义 Starter 组件。下一章介绍 Spring Boot Web 开发相关。</p>
<p>本章内容</p>
<ol>
<li>自定义属性快速入门</li>
<li>外化配置</li>
<li>自动配置</li>
<li>自定义创建 Starter 组件</li>
</ol>
<p>本章示例代码地址：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/JeffLi1993/springboot-core-action-book-demo">https://github.com/JeffLi1993/springboot-core-action-book-demo</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/JeffLi1993/springboot-learning-example">https://github.com/JeffLi1993/springboot-learning-example</a></li>
</ul>

        </div>

    </div>

    <div class="article-copyright">

        <div style="float: left;width: 20%;align:center;text-align: center;">
             <img style="width: 100px; height: 100px;" src="https://image.bysocket.com/2023/02/qrcode.webp" alt="QRCode" >
        </div>
        <div style="float: left;width: 80%;">
                <br/>
                本文由 <a target="_blank" rel="noopener" href="https://www.bysocket.com/">泥瓦匠</a> 创作<br/><br/>
                原创不易，欢迎关注公众号！转载请注明出处，感谢支持！如果本文对您有用，欢迎转发分享！
        </div>

      </div><br/><br/><br/><br/><br/>

    

    

    

    
  <div class="article-copyright hairline">
    <p>
      本作品采用  <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)</a> 进行许可。
    </p>
  </div>
  

    

    
<nav class="article-nav">
  
    <a href="/spring-boot-freemarker/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-caption">下一篇</div>
      <div class="article-nav-title">
        
          Spring Boot 整合 FreeMarker Web 案例教程
        
      </div>
    </a>
  
  
    <a href="/spring-boot-quickstart-example/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">上一篇</div>
      <div class="article-nav-title">Spring Boot 快速入门案例教程</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">分享</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=Spring Boot 配置 properties 文件案例教程 - 程序员泥瓦匠&url=https%3A%2F%2Fbysocket.com%2Fspring-boot-configuration-properties-example%2F">
            <ion-icon name="logo-twitter"></ion-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=Spring Boot 配置 properties 文件案例教程 - 程序员泥瓦匠&u=https%3A%2F%2Fbysocket.com%2Fspring-boot-configuration-properties-example%2F">
            <ion-icon name="logo-facebook"></ion-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=Spring Boot 配置 properties 文件案例教程 - 程序员泥瓦匠&url=https://bysocket.com/spring-boot-configuration-properties-example/&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>
















</div>
                </section>
            </section>

            
            <aside class="sidebar ">
                


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-cate">
    <div class="widget-title"><span>分类</span></div>
    <div class="widget-inner">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ElasticSearch/">ElasticSearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ElasticSearch/Elasticsearch/">Elasticsearch</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/">Elasticsearch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTTP/">HTTP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JDK/">JDK</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JSP/">JSP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Microservice-Architecture/">Microservice Architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SEO/">SEO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/">Spring Boot</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/ElasticSearch/">ElasticSearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot/ElasticSearch/Elasticsearch/">Elasticsearch</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Boot-WebFlux/">Spring Boot WebFlux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%80%9D%E8%80%83/">思考</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/">问题记录</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>标签</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AdSense/" rel="tag">AdSense</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Architecture/" rel="tag">Architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ChatGPT/" rel="tag">ChatGPT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Collections/" rel="tag">Collections</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Config/" rel="tag">Config</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Druid/" rel="tag">Druid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dubbo/" rel="tag">Dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ElasticSearch/" rel="tag">ElasticSearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FreeMarker/" rel="tag">FreeMarker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HBase/" rel="tag">HBase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashSet/" rel="tag">HashSet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/" rel="tag">IDEA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java-IO/" rel="tag">Java IO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LinkedHashSet/" rel="tag">LinkedHashSet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/" rel="tag">Mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenAI/" rel="tag">OpenAI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Properties/" rel="tag">Properties</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/REST/" rel="tag">REST</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Servlet/" rel="tag">Servlet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Data/" rel="tag">Spring Data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Thymeleaf/" rel="tag">Thymeleaf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TreeSet/" rel="tag">TreeSet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UUID/" rel="tag">UUID</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Validation/" rel="tag">Validation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZooKeeper/" rel="tag">ZooKeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E7%90%86/" rel="tag">原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/" rel="tag">配置文件</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>最新文章</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/microservice-architecture/">微服务架构一直火，为什么服务化要搞懂</a>
          </li>
        
          <li>
            <a href="/elasticsearch-7-node/">Elasticsearch 7.x 之节点、集群、分片及副本（快速入门）</a>
          </li>
        
          <li>
            <a href="/elasticsearch-7-index-documents/">Elasticsearch 7.x 之文档、索引和 REST API（快速入门）</a>
          </li>
        
          <li>
            <a href="/elasticsearch-7-install/">Elasticsearch 7.x 如何安装及配置（最详细）</a>
          </li>
        
          <li>
            <a href="/mac-create-files-from-the-root-directory/">Mac 系统如何利用软链接在根目录创建文件夹？</a>
          </li>
        
      </ul>
    </div>
  </div>

    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <!-- Please do not remove this -->
    <!-- 开源不易，请勿删除 -->
    <div class="footer-wrap">
        <div class="footer-inner"> 
            程序员泥瓦匠 &copy; 2023<br>
            <a href="https://beian.miit.gov.cn" rel="nofollow" target="_blank">浙ICP备15028451号-7</a> | <a href="https://www.decompilertool.com/" target="_blank">Java Decompiler</a>
        </div>
    </div>

</footer>

<script type="module" src="https://unpkg.com/ionicons@6.0.2/dist/ionicons/ionicons.esm.js"></script>






<script src="/dist/build.js?1654266144177.js"></script>


<script src="/dist/custom.js?1654266144177.js"></script>



<!-- 百度链接提交 -->
<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>



<!-- Google Analytics-->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RR50H8B3V1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-RR50H8B3V1');
</script>








<!-- Baidu Analytics-->
<script type="text/javascript">
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?e43a8b7f6b87c80c7d5d89ee04348971";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>

</html>